---
title: "01.JVM 성능"
excerpt: "JVM의 성능 종류"
categories:
    - JVM
tags:
    - 자바 프로그래밍 기초
    - 컴파일 환경
last_modified_at: 2021-05-18
---

# 컴파일 환경
![클래스파일 전체 로직.png](../image/JVM/ch2/JAVA-running-logic.png) 
* 자바를 실행하는데에는 크게 컴파일타임과 런타임 두가지 과정을 거쳐야 한다.
* 우리가 JAVA를 처음 배울때 프레임워크를 사용하지 않고, cmd로만 구동을 시키는 실습을 떠올려보자.
    ```
    javac 클래스명.java
    java 클래스명 
    ```
* 여기서 **javac에 해당하는 명령이 바로 컴파일 환경** 작업이다.
* 목적은 우리가 만든 **자바 소스코드를(.java)을 컴파일러를 통해 자바 바이트코드(.class)로 만드는 것이다.**

## 바이트코드
* 바이트코드는 **컴파일러 또는 가상 시스템에서 내부적으로만 사용되는, 중간 표현형코드**이다.
* 특정 컴퓨터 아키텍처에 포함되어 있지 않기 때문에 이식성이 좋다.(JVM을 지원하는 어느 컴퓨터든 실행이 가능.)

### 바이트코드 구조
![바이트코드 구조 표.png](../image/JVM/ch2/bytecode-arr.png)

![bytecodeoverview.png](../image/JVM/ch2/bytecodeoverview.png)
#### 매직넘버
* 이 파일이 **클래스 파일임을 나타내는 넘버링 코드**(모든 클래스 파일은 0xCAFEBABE로 시작된다.)
* 자바9부터는 `0xCAFEDADA` 매직넘버를 쓰기로 함.

#### 클래스 파일 포맷 버전
* 클래스 파일을 컴파일할 때 꼭 필요한 메이저/마이너 버전 숫자를 표시
* 만약 **실행대상 JVM이 컴파일한 JVM에 호환되지 않으면 `UnsupportedClassVersionError` 예외**가 던져짐.
![JVM 호환이 안되는 경우.png](../image/JVM/ch2/UnsupportedClassVersionError.png)

    
#### 상수 풀
* 코드 곳곳에 등장하는 상수값(클래스명, 인터페이스명, 필드명)이 있다.
* **코드를 실행할 때 런타임에 배치된 메모리 대신, 이 상수 풀 테이블을 찾아보고 필요한 값을 참조.**

#### 액세스 플래그
* 세 구간으로 나누어 표시.
* 클래스의 **접근 권한**을 표시해놓음. (`public`, `final`)
* 클래스파일이 **인터페이스인지, 추상클래스**인지 표시
* 클래스 파일이 소스 코드에 없는 **합성 클래스인지, 어노테이션 타입인지, 이늄**인지를 각각 나타냄.
* ex : ACC_PUBLIC(0x0001), ACC_FINAL(0x0010)

#### this, 슈퍼 클래스, 인터페이스
* 클래스에 포함된 타입 계층
* 상수 풀을 가리키는 인덱스로 표시.

#### 필드, 메소드
* 시그니처와 비슷한 구조를 정의. (수정자도 포함됨.)

#### 속성
* 복잡하고 크기가 고정되지 않은 구조를 나타내는데 쓰임.

## 예시
```java
public class HelloWorld{
    public static void main(String[] args){
        for (int i = 0; i < 10; i++) {
            System.out.println("Hello World!");
        }
    }
}
```

## 참고&출처
* https://blog.lse.epita.fr//2014/04/28/0xcafebabe-java-class-file-format-an-overview.html
* 자바 최적화